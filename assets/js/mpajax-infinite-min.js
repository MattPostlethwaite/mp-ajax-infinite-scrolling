"use strict";var SnapbackCache=function e(t){var t=t||{},o=function(){return{set:function e(t,o,n){var a=sessionStorage.getItem(t);a=a?JSON.parse(a):{},n?a[o]=JSON.stringify(n):delete a[o],sessionStorage.setItem(t,JSON.stringify(a))},get:function e(t,o,n){var a=sessionStorage.getItem(t);return a&&(a=JSON.parse(a),a[o])?JSON.parse(a[o]):null}}}(),n=!0,a=function e(){n=!1},r=function e(){n=!0},i=function e(){return!!(sessionStorage&&history&&n)},c=function e(t,n){n&&h(),o.set("pageCache",t,n)},s=function e(t){return o.get("pageCache",t)},u=function e(t){c(t,null)},p=function e(){"function"==typeof t.removeAutofocus&&v()&&t.removeAutofocus()},l=function e(o,n){if("function"==typeof o&&(n=o,o=null),!i())return void(n&&n());jQuery(document).finish(),"function"==typeof t.wait&&t.finish(),setTimeout(function(){"function"==typeof t.removeAutofocus&&t.removeAutofocus();var e=jQuery(t.bodySelector);o&&(e=e.clone().find(o).replaceWith("").end());var a={body:e.html(),title:document.title,positionY:window.pageYOffset,positionX:window.pageXOffset,cachedAt:(new Date).getTime()};"function"==typeof t.nextPageOffset&&(a.nextPageOffset=t.nextPageOffset()),c(document.location.href,a),jQuery(t.bodySelector).trigger("snapback-cache:cached",a),n&&n()},500)},f=function e(o){if(v()){var n=s(document.location.href);jQuery(t.bodySelector).html(n.body),"function"==typeof t.removeAutofocus&&t.removeAutofocus(),setTimeout(function(){window.scrollTo(n.positionX,n.positionY)},1),u(document.location.href),jQuery(t.bodySelector).trigger("snapback-cache:loaded",n);var a=m();return a&&("function"==typeof t.refreshItems&&t.refreshItems(a),d()),!1}o&&o()},d=function e(){sessionStorage.removeItem("pageCache-dirty")},m=function e(){var t=sessionStorage.getItem("pageCache-dirty");if(t){var o=JSON.parse(t);return jQuery.map(o,function(e,t){return t})}return null},g=function e(t){o.set("pageCache-dirty",t,!0)},h=function e(){var t=sessionStorage.getItem("pageCache");if(t){t=JSON.parse(t);var o=[];for(var n in t)o.push([n,t[n]]);if(o.length>=10){o.sort(function(e,t){return e=e[1].cachedAt,t=t[1].cachedAt,t<e?-1:t>e?1:0});for(var a=0;a<o.length+1-10;a++){var n=o[a][0];delete t[n]}sessionStorage.setItem(namespace,JSON.stringify(t))}}},v=function e(){if(!i())return!1;var t=s(document.location.href);return!!(t&&t.cachedAt>(new Date).getTime()-9e5)};return jQuery(document).ready(function(){p()}),jQuery(window).load(function(){f()}),{enable:r,disable:a,remove:u,loadFromCache:f,cachePage:l,markDirty:g,willUseCacheOnThisPage:v}},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function($){function e(e){var t=P>1?"Scroll up to load the previous pages":"Scroll up to load the previous page";$("html").addClass("mpajax"),1!=C&&($("body").prepend('<div class="mpajax-spacer" style="height: 10px"></div>'),0==N.scrollTop()&&window.scrollTo(0,10)),$(e+" .cards").attr("id","mpajax-content-"+C).addClass("mpajax-content-wrapper loaded").attr("data-section-name","mpajax-content-wrapper-page-"+C).attr("data-section-url",f),0!==P&&0===$("."+w).length&&$(e+" .mpajax-content-wrapper.loaded:first").before(Q("Load Previous",h)+"\n"+U(t,"load-previous-message")+"\n"+J(P,_,w)),T<=O&&0===$("."+x).length&&$(e).append(J(T,L,x)+"\n"+Q("Load More",v)),$(".module-pagination, .woocommerce-pagination, .results-count, .woocommerce-result-count").remove()}function t(e,t,o){var n=e;return t=(void 0===t?"undefined":_typeof(t))===_typeof("string")&&t,o=(void 0===o?"undefined":_typeof(o))===_typeof("string")?o:d,t&&(n=n.replace(/page\/[0-9]*\//,t)),n=n.replace(/\?(.*)/,o)}function o(e,t,o){var n=N.scrollTop(),a=N.height(),r={section_name:"",section_url:""},i=n+a;return(void 0===t?"undefined":_typeof(t))===_typeof(1)&&((void 0===o?"undefined":_typeof(o))!==_typeof(!0)&&(o=!1),o?i+=t:i-=t),$(e).each(function(){var e=$(this),t=e.offset().top;Math.round(t)<Math.round(i)&&(r.section_url=e.attr("data-section-url"),r.section_name=e.attr("data-section-name"))}),r}function n(){if(window.history.replaceState){var e=Math.round(N.height()/2),t=".mpajax-content-wrapper",n=o(t,e).section_url;""!=n&&n!=I&&(window.location.href!=n&&history.replaceState(null,null,n),I=n)}}function a(){var e=N.height(),t=$(".mpajax-content-wrapper.loaded").last(),o=t.offset().top;if(Math.round(N.scrollTop()+e)>Math.round(o)&&(!$("body").hasClass("loading")&&T<=O&&c("#content .cards",L,"."+x),T>O))return i("."+v,"No more to load",!0),!1}function r(){var e=$(".mpajax-content-wrapper.loaded:first"),t=e.offset().top;N.scrollTop()<t&&(!$("body").hasClass("loading")&&P>0&&c("#content .cards",_,".mpajax-placeholder-prev"),$(".mpajax-spacer").remove())}function i(e,t,o){$(e).html(t),o?$(e).addClass("disabled"):$(e).removeClass("disabled")}function c(e,t,o){var n=o.replace("."+y+"-",""),a="."+m+"-"+n,r="next"===n?"Load More":"Load Previous";return $("body").addClass("loading"),i(a,"Loading more "+b,!0),$("."+S+"-"+n).remove(),$(o).load(t+" "+e,function(e,t,c){if(4==c.readyState&&"error"==t)return u(c,n),!1;$(this).removeClass("mpajax-placeholder "+o.replace(".","")).addClass("mpajax-content-wrapper loaded"),s(n),i(a,r,!1),$("body").removeClass("loading")}),!1}function s(e){if("next"===e)T++,L=t(L,"page/"+T+"/"),T<=O&&0===$(x).length&&$("."+v+"-wrapper").before(J(T,L,x));else{var o=$(".mpajax-content-wrapper.loaded:first").height();if(window.scrollTo(0,N.scrollTop()+o),P--,_=t(_,"page/"+P+"/"),0!==P&&0===$("."+w).length&&$(".mpajax-content-wrapper.loaded:first").before(J(P,_,w)),0===P)return $("."+h+"-wrapper, .load-previous-message").remove(),!1}}function u(e,t){var o="."+m+"-"+t,n=S+"-"+t;e.status=504,404==e.status?($(o).before(U("Sorry we are unable to find the page to load",S+" "+n)),i(o,"Unable to load",!0)):500===e.status?($(o).before(U("Sorry something went wrong, please try clicking the load button",S+" "+n)),"next"==t?i(o,"Load more"):i(o,"Load previous")):($(o).before(U("Sorry something went wrong, please try refreshing the page",S+" "+n)),i(o,"Unable to load",!0))}function p(){var e=SnapbackCache({bodySelector:"#content",nextPageOffset:function e(){return{nextURL:L,prevURL:_,nextNum:T,prevNum:P}}});$("#content").on("snapback-cache:loaded",function(e,t){L=t.nextPageOffset.nextURL,T=t.nextPageOffset.nextNum,_=t.nextPageOffset.prevURL,P=t.nextPageOffset.prevNum,A=!1}),$(document).on("click","a",function(){e.cachePage()}),function e(){var t=sessionStorage.pageCache;t&&(t=JSON.parse(t),t[window.location.href]&&(A=!0))}()}function l(){p(),$(document).on("ready",function(){e("#content"),A||($("."+h).click(function(e){e.preventDefault(),$(this).hasClass("disabled")||c("#content .cards",_,".mpajax-placeholder-prev")}),$("."+v).click(function(e){e.preventDefault(),$(this).hasClass("disabled")||c("#content .cards",L,".mpajax-placeholder-next")}))}),N.on("scroll",function(){if(!A){var e=window.pageYOffset||document.documentElement.scrollTop;n(),e>k?(k=e,a()):(k=e,r())}})}var f=window.location.href,d=window.location.search,m="mpajax-load-button",g=m+"-wrapper",h=m+"-prev",v=m+"-next",y="mpajax-placeholder",w=y+"-prev",x=y+"-next",b='<i class="fa fa-spinner fa-pulse fa-fw" style="width: 14px; height: 14px;"></i>',S="mpajax-loading-error-message",j=$(".total-page-count"),C=parseInt(mpajax.startPage),O=0===j.length||isNaN(j.html())?parseInt(mpajax.maxPages):Number(j.html()),N=$(window),P=C-1,T=C+1,_=mpajax.prevPageURL,L=mpajax.nextPageURL,I="",k=0,A=!1,J=function e(t,o,n){return'<div id="mpajax-content-'+t+'" class="'+y+" "+n+'" data-section-name="mpajax-content-wrapper-page-'+t+'" data-section-url="'+o+'"></div>'},Q=function e(t,o){return'<div class="'+g+" "+o+'-wrapper" class="clearfix"><button class="button '+m+" "+o+'">'+t+"</button></div>"},U=function e(t,o){return'<div class="mpajax-message '+o+'"><p>'+t+"</p></div>"};l()}(jQuery);
//# sourceMappingURL=./mpajax-infinite-min.js.map